name: PR approved workflow

on:
  issue_comment:
    types:
      - created

jobs:
  debug-log:
    name: "debug test"
    runs-on: ubuntu-latest
    steps:
      - name: "step"
        run: |
          echo ${{ github.event.comment.body }}
          echo ${{ github.event.comment.author_association }}
          echo ${{ github.event }}
          echo ${{ github.event.issue.pull_request }}

  load-files:
    name: "Load files"
    runs-on: ubuntu-latest
    outputs:
      matrix: ${{ steps.set-output.outputs.e2eFiles }}
    steps:
      - id: set-output
        run: echo "e2eFiles=azerty2" >> $GITHUB_OUTPUT


  build:
    name: "Build"
    runs-on: ubuntu-latest
    needs: [load-files]
    if: |
      ${{ github.event.comment.body == '/run-cctp-tests' }} && github.event.issue.pull_request
      && needs.load-files.outputs.matrix == 'azerty2'
    steps:
      - name: test
        run: echo "build running"
        

  # test-e2e-success:
  #   name: "Test E2E Success"
  #   runs-on: ubuntu-latest
  #   if: always()
  #   steps:
  #     - name: Regular E2E Succeeded
  #       run: |
  #         github.checks.create({
  #           name: 'Run test',
  #           head_sha: '${{ github.event.issue.pull_request.head.sha }}',
  #           status: 'completed',
  #           conclusion: '${{ steps.tests-step.outcome }}',
  #           output: {
  #             title: 'Run tests',
  #             summary: 'Results: ${{ steps.tests-step.outcome }}'
  #           },
  #           owner: context.repo.owner,
  #           repo: context.repo.repo
  #         })

  